define(["@grafana/data","@grafana/ui","react","@grafana/runtime","@emotion/css","lodash"],((e,t,n,r,a,o)=>(()=>{var l={629:(e,t,n)=>{var r=n(305),a=n(388),o=n(650),l=n(980),i=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(o);const c={JWT:"jwt",GCE:"gce"},s=["private_key","token_uri","client_email","project_id"],u=({onChange:e,showConfigEditor:t})=>{const[n,r]=o.useState(),[l,c]=o.useState(null),s=a.useTheme2(),u=o.useCallback((e=>{r(null),c(!0)}),[c]),d=o.useCallback((e=>{c(null),r(null)}),[c]),m=o.useCallback((n=>{if(""!==n.trim()){let a;try{a=JSON.parse(n)}catch(e){r("Invalid JWT token")}const o=p(a);o.isValid?(t(),e({privateKey:a.private_key,tokenUri:a.token_uri,clientEmail:a.client_email,projectId:a.project_id})):r(o.error)}}),[r,e,t]);return i.default.createElement(i.default.Fragment,null,i.default.createElement(a.Field,{label:"JWT token",invalid:Boolean(n),description:l?"Paste JWT token below":"Upload or paste Google JWT token",error:n},i.default.createElement(i.default.Fragment,null,!0!==l&&i.default.createElement("div",{"data-testid":"Configuration drop zone"},a.FileDropzone&&i.default.createElement(a.FileDropzone,{options:{multiple:!1,accept:".json"},readAs:"readAsText",onLoad:e=>{m(e),c(!1)}},i.default.createElement("p",{style:{margin:0,fontSize:`${s.typography.h4.fontSize}`,textAlign:"center"}},"Drop the Google JWT file here",i.default.createElement("br",null),i.default.createElement("br",null),i.default.createElement(a.Button,{fill:"outline"},"Click to browse files")))),l&&i.default.createElement(a.TextArea,{"data-testid":"Configuration text area",autoFocus:!0,invalid:Boolean(n),placeholder:"Paste Google JWT token here",onBlur:e=>m(e.currentTarget.value),rows:12}))),!l&&i.default.createElement(i.default.Fragment,null,i.default.createElement(a.Button,{"data-testid":"Paste JWT button",type:"button",fill:"outline",style:{color:`${s.colors.primary.text}`},onClick:u},"Paste JWT Token"),i.default.createElement("span",{style:{paddingRight:"10px",paddingLeft:"10px"}},"or"),i.default.createElement(a.Button,{"data-testid":"Fill JWT info manually",type:"button",fill:"outline",style:{color:`${s.colors.primary.text}`},onClick:t},"Fill In JWT Token manually")),l&&n&&i.default.createElement(a.Field,null,i.default.createElement(a.Button,{type:"button",fill:"outline",style:{color:`${s.colors.primary.text}`},onClick:d},"Upload JWT Token")))},p=e=>{if(!l.isObject(e))return{isValid:!1,error:"Invalid JWT token"};const t=s.filter((t=>!e[t]));return t.length>0?{isValid:!1,error:`Missing keys: ${t.join(", ")}`}:{isValid:!0}},{SecretFormField:d}=a.LegacyForms;var m;!function(e){e.PATH="path",e.JWT="jwt"}(m||(m={}));const h=({options:e,onReset:t,onOptionsChange:n})=>{var o;const[l,c]=i.default.useState((e=>"privateKeyPath"in e&&""!==e.privateKeyPath?m.PATH:m.JWT)(e.jsonData)),s=t=>r.onUpdateDatasourceJsonDataOption({options:e,onOptionsChange:n},t),u=()=>{l===m.JWT?c(m.PATH):c(m.JWT)},p=i.default.createElement("span",null,l===m.PATH?i.default.createElement("a",{className:"external-link",onClick:u,"data-testid":"Show private key input"},"Paste private key"):"Paste private key"," ","or  ",l===m.JWT?i.default.createElement("a",{className:"external-link",onClick:u,"data-testid":"Show private key path input"},"provide path to private file"):"provide path to private key file"),h={isConfigured:Boolean(e.secureJsonFields.privateKey),value:(null===(o=e.secureJsonData)||void 0===o?void 0:o.privateKey)||"",placeholder:"Enter Private key",onReset:()=>t(),onChange:r.onUpdateDatasourceSecureJsonDataOption({options:e,onOptionsChange:n},"privateKey"),"data-testid":"Private Key Input"};return i.default.createElement("div",{"data-testid":"JWT form"},i.default.createElement(a.Field,{label:"Project ID"},i.default.createElement(a.Input,{id:"defaultProject",width:60,value:e.jsonData.defaultProject||"",onChange:s("defaultProject")})),i.default.createElement(a.Field,{label:"Client email"},i.default.createElement(a.Input,{width:60,id:"clientEmail",value:e.jsonData.clientEmail||"",onChange:s("clientEmail")})),i.default.createElement(a.Field,{label:"Token URI"},i.default.createElement(a.Input,{width:60,id:"tokenUri",value:e.jsonData.tokenUri||"",onChange:s("tokenUri")})),l===m.PATH&&i.default.createElement(a.Field,{label:"Private key path",description:p},i.default.createElement(a.Input,{width:60,id:"privateKeyPath",value:e.jsonData.privateKeyPath||"",placeholder:"File location of your private key (e.g. /etc/secrets/gce.pem)",onChange:s("privateKeyPath"),"data-testid":"Private Key Path Input"})),l===m.JWT&&i.default.createElement(i.default.Fragment,null,a.SecretInput?i.default.createElement(a.Field,{label:"Private key",description:p},i.default.createElement(a.SecretInput,Object.assign({},h,{width:60}))):i.default.createElement(d,Object.assign({},h,{label:"Private key",labelWidth:10,inputWidth:20}))))};const f=e=>e===c.JWT||void 0===e,g=[{label:"Google JWT File",value:c.JWT,ariaLabel:"JWT button"},{label:"GCE Default Service Account",value:c.GCE,ariaLabel:"GCE button"}];t.AuthConfig=function(e){const{options:t,onOptionsChange:n,authOptions:l}=e,{jsonData:s,secureJsonFields:p,secureJsonData:d}=t,m=()=>Boolean(s.clientEmail&&s.defaultProject&&s.tokenUri&&(p&&p.privateKey||s.privateKeyPath));s.authenticationType||(s.authenticationType=c.JWT);const[g,y]=o.useState(f(s.authenticationType)),[b,v]=o.useState(m());return i.default.createElement(i.default.Fragment,null,i.default.createElement(a.FieldSet,{label:"Authentication"},i.default.createElement(a.Field,{label:"Authentication type"},i.default.createElement(a.RadioButtonGroup,{options:l,value:s.authenticationType||c.JWT,onChange:e=>{v(m()),n(Object.assign(Object.assign({},t),{jsonData:Object.assign(Object.assign({},t.jsonData),{authenticationType:e})})),y(f(e))}}))),g&&i.default.createElement(a.FieldSet,{label:"JWT Key Details"},b?i.default.createElement(h,{options:t,onReset:()=>(e=>{const r=Object.assign({},d),a=Object.assign({},t.jsonData);delete a.clientEmail,delete a.defaultProject,delete a.tokenUri,delete a.privateKeyPath,delete r.privateKey,y(!0),v(!1),n(Object.assign(Object.assign({},t),{secureJsonFields:Object.assign(Object.assign({},t.secureJsonFields),{privateKey:!1}),secureJsonData:r,jsonData:a}))})(),onOptionsChange:n}):i.default.createElement(u,{showConfigEditor:()=>{v(!0)},onChange:e=>{n(Object.assign(Object.assign({},t),{secureJsonFields:Object.assign(Object.assign({},p),{privateKey:!0}),secureJsonData:Object.assign(Object.assign({},d),{privateKey:e.privateKey}),jsonData:Object.assign(Object.assign({},s),{clientEmail:e.clientEmail,defaultProject:e.projectId,tokenUri:e.tokenUri})}))}})," "),s.authenticationType===c.GCE&&i.default.createElement(a.Field,{label:"Default project"},i.default.createElement(a.Input,{id:"defaultProject",width:60,value:t.jsonData.defaultProject||"",onChange:r.onUpdateDatasourceJsonDataOption(e,"defaultProject")})))},t.GOOGLE_AUTH_TYPE_OPTIONS=g,t.GoogleAuthType=c},649:(e,t,n)=>{"use strict";e.exports=n(629)},644:e=>{"use strict";e.exports=a},305:t=>{"use strict";t.exports=e},545:e=>{"use strict";e.exports=r},388:e=>{"use strict";e.exports=t},980:e=>{"use strict";e.exports=o},650:e=>{"use strict";e.exports=n}},i={};function c(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return l[e](n,n.exports,c),n.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{"use strict";c.r(s),c.d(s,{plugin:()=>L});var e=c(305),t=c(388),n=c(650),r=c.n(n),a=c(545),o=c(644);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){l(e,t,n[t])}))}return e}function u(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function p(e){let t=`https://docs.google.com/spreadsheets/d/${e.spreadsheet}/view`;return e.range&&(t+="#range="+e.range),t}const d=(e=300)=>e<60?e+"s":e<3600?e/60+"m":e/3600+"h";class m extends n.PureComponent{componentDidMount(){this.props.query.hasOwnProperty("cacheDurationSeconds")||(this.props.query.cacheDurationSeconds=300)}render(){const{query:e,onRunQuery:n,onChange:o,datasource:l}=this.props,c=f();return r().createElement(r().Fragment,null,r().createElement(t.InlineFieldRow,{className:c.rowSpacing},r().createElement(t.InlineFormLabel,{width:10,className:"query-keyword",tooltip:r().createElement("p",null,"The ",r().createElement("code",null,"spreadsheetId")," is used to identify which spreadsheet is to be accessed or altered. This ID is the value between the &quot/d/&quot and the &quot/edit&quot in the URL of your spreadsheet.")},"Spreadsheet ID"),r().createElement(t.SegmentAsync,{loadOptions:()=>l.getSpreadSheets(),placeholder:"Enter SpreadsheetID",value:e.spreadsheet,allowCustomValue:!0,onChange:this.onSpreadsheetIDChange}),e.spreadsheet&&r().createElement(t.LinkButton,{style:{marginTop:1},fill:"text",icon:"link",href:p(e),target:"_blank",onClick:()=>(0,a.reportInteraction)("grafana_google_sheets_document_opened",{})}),r().createElement(h,null)),r().createElement(t.InlineFieldRow,{className:c.rowSpacing},r().createElement(t.InlineFormLabel,{width:10,className:"query-keyword",tooltip:r().createElement("p",null,"A string like ",r().createElement("code",null,"Sheet1!A1:B2"),", that refers to a group of cells in the spreadsheet, and is typically used in formulas. Named ranges are also supported. When a named range conflicts with a sheet’s name, the named range is preferred.")},"Range"),r().createElement(t.Input,{width:30,value:e.range||"",onChange:this.onRangeChange,onBlur:n,placeholder:"Class Data!A2:E",className:c.marginRight}),r().createElement(h,null)),r().createElement(t.InlineFieldRow,{className:c.rowSpacing},r().createElement(t.InlineFormLabel,{width:10,className:"query-keyword",tooltip:"Time in seconds that the spreadsheet will be cached in Grafana after receiving a response from the spreadsheet API"},"Cache Time"),r().createElement(t.Segment,{value:{label:d(e.cacheDurationSeconds),value:e.cacheDurationSeconds},options:[0,5,10,30,60,120,300,600,1800,3600,7200,18e3].map((e=>({label:d(e),value:e,description:e?"":"Response is not cached at all"}))),onChange:({value:t})=>{(0,a.reportInteraction)("grafana_google_sheets_cache_updated",{secondsValue:t}),o(u(i({},e),{cacheDurationSeconds:t}))}}),r().createElement(h,null)),r().createElement(t.InlineFieldRow,{className:c.rowSpacing},r().createElement(t.InlineFormLabel,{width:10,className:"query-keyword",tooltip:"Apply the dashboard time range to the first time fieldAPI"},"Use Time Filter"),r().createElement(t.InlineSwitch,{className:c.marginRight,value:!0===e.useTimeFilter,onChange:this.toggleUseTimeFilter}),r().createElement(h,null)))}constructor(...e){super(...e),this.onRangeChange=e=>{this.props.onChange(u(i({},this.props.query),{range:e.target.value}))},this.onSpreadsheetIDChange=e=>{const{query:t,onRunQuery:n,onChange:r}=this.props;if(!e.value)return;const a=e.value;/(.*)\/spreadsheets\/d\/(.*)/.test(a)?r(i({},t,function(e){let t=null==e?void 0:e.indexOf("/d/");if(!t)return{spreadsheet:e};let n=e.substring(t+3);return t=n.indexOf("/"),t&&(n=n.substring(0,t)),t=e.indexOf("range="),t>0?{spreadsheet:n,range:e.substring(t+"range=".length)}:{spreadsheet:n}}(a))):r(u(i({},t),{spreadsheet:a})),n()},this.toggleUseTimeFilter=e=>{const{query:t,onChange:n,onRunQuery:r}=this.props;(0,a.reportInteraction)("grafana_google_sheets_time_filter_toggled",{checked:!t.useTimeFilter}),n(u(i({},t),{useTimeFilter:!t.useTimeFilter})),r()}}}const h=()=>{const e=f();return r().createElement(t.InlineFormLabel,{className:e.rowTerminator},r().createElement(r().Fragment,null))},f=()=>({rowSpacing:(0,o.css)({marginBottom:"4px"}),rowTerminator:(0,o.css)({flexGrow:1}),marginRight:(0,o.css)({marginRight:"4px"})});var g=c(649);function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const b=(v=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){y(e,t,n[t])}))}return e}({},g.GoogleAuthType),O=null!=(O={API:"key"})?O:{},Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(O)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(O)).forEach((function(e){Object.defineProperty(v,e,Object.getOwnPropertyDescriptor(O,e))})),v);var v,O;const E=[{label:"API Key",value:b.API},...g.GOOGLE_AUTH_TYPE_OPTIONS];function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){j(e,t,n[t])}))}return e}const w=({authenticationType:e})=>{const[a,o]=(0,n.useState)(!1),l=(0,t.useTheme2)();return r().createElement(t.Collapse,{collapsible:!0,label:"Configure Google Sheets Authentication",isOpen:a,onToggle:()=>o((e=>!e))},(()=>{switch(e){case b.API:return r().createElement(r().Fragment,null,r().createElement("h4",null,"Generate an API key"),r().createElement("ol",{style:{listStylePosition:"inside"}},r().createElement("li",null,"Open the"," ",r().createElement("a",{href:"https://console.developers.google.com/apis/credentials",target:"_blank",rel:"noreferrer noopener",style:{color:l.colors.text.link}},"Credentials page")," ","in the Google API Console."),r().createElement("li",null,"Click ",r().createElement("strong",null,"Create Credentials")," and then click ",r().createElement("strong",null,"API key"),"."),r().createElement("li",null,"Copy the key and paste it in the API Key field above. The file contents are encrypted and saved in the Grafana database.")));case b.GCE:return r().createElement(r().Fragment,null,r().createElement("p",null,"When Grafana is running on a Google Compute Engine (GCE) virtual machine, Grafana can automatically retrieve default credentials from the metadata server. As a result, there is no need to generate a private key file for the service account. You also do not need to upload the file to Grafana. The following preconditions must be met before Grafana can retrieve default credentials."),r().createElement("ol",{style:{listStylePosition:"inside",marginBottom:l.spacing()}},r().createElement("li",null,"You must create a Service Account for use by the GCE virtual machine. For more information, refer to"," ",r().createElement("a",{href:"https://cloud.google.com/compute/docs/access/create-enable-service-accounts-for-instances#createanewserviceaccount",target:"_blank",style:{color:l.colors.text.link},rel:"noreferrer noopener"},"Create new service account"),"."),r().createElement("li",null,"Verify that the GCE virtual machine instance is running as the service account that you created. For more information, refer to"," ",r().createElement("a",{href:"https://cloud.google.com/compute/docs/access/create-enable-service-accounts-for-instances#using",target:"_blank",style:{color:l.colors.text.link},rel:"noreferrer noopener"},"setting up an instance to run as a service account"),"."),r().createElement("li",null,"Allow access to the specified API scope.")),r().createElement("p",null,"For more information about creating and enabling service accounts for GCE instances, refer to"," ",r().createElement("a",{href:"https://cloud.google.com/compute/docs/access/create-enable-service-accounts-for-instances",target:"_blank",style:{color:l.colors.text.link},rel:"noreferrer noopener"},"enabling service accounts for instances in Google documentation"),"."));default:return r().createElement(r().Fragment,null,r().createElement("h4",null,"Generate a JWT file"),r().createElement("ol",{style:{listStylePosition:"inside",marginBottom:l.spacing()}},r().createElement("li",null,"Open the"," ",r().createElement("a",{href:"https://console.developers.google.com/apis/credentials",target:"_blank",style:{color:l.colors.text.link},rel:"noreferrer noopener"},"Credentials")," ","page in the Google API Console."),r().createElement("li",null,"Click ",r().createElement("strong",null,"Create Credentials")," then click ",r().createElement("strong",null,"Service account"),"."),r().createElement("li",null,"On the Create service account page, enter the Service account details."),r().createElement("li",null,"On the ",r().createElement("code",null,"Create service account")," page, fill in the ",r().createElement("code",null,"Service account details")," and then click ",r().createElement("code",null,"Create")),r().createElement("li",null,"On the ",r().createElement("code",null,"Service account permissions")," page, don’t add a role to the service account. Just click ",r().createElement("code",null,"Continue")),r().createElement("li",null,"In the next step, click ",r().createElement("code",null,"Create Key"),". Choose key type ",r().createElement("code",null,"JSON")," and click"," ",r().createElement("code",null,"Create"),". A JSON key file will be created and downloaded to your computer"),r().createElement("li",null,"Open the"," ",r().createElement("a",{href:"https://console.cloud.google.com/apis/library/sheets.googleapis.com?q=sheet",target:"_blank",style:{color:l.colors.text.link},rel:"noreferrer noopener"},"Google Sheets")," ","in API Library and enable access for your account"),r().createElement("li",null,"Open the"," ",r().createElement("a",{href:"https://console.cloud.google.com/apis/library/drive.googleapis.com?q=drive",target:"_blank",style:{color:l.colors.text.link},rel:"noreferrer noopener"},"Google Drive")," ","in API Library and enable access for your account. Access to the Google Drive API is used to list all spreadsheets that you have access to."),r().createElement("li",null,"Share any private files/folders you want to access with the service account's email address. The email is specified as ",r().createElement("code",null,"client_email")," in the Google JWT File."),r().createElement("li",null,"Drag the file to the dotted zone above. Then click ",r().createElement("code",null,"Save & Test"),". The file contents will be encrypted and saved in the Grafana database.")))}})())};var k=Object.defineProperty,T=Object.defineProperties,S=Object.getOwnPropertyDescriptors,D=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable,I=(e,t,n)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,J=(e,t)=>{for(var n in t||(t={}))C.call(t,n)&&I(e,n,t[n]);if(D)for(var n of D(t))F.call(t,n)&&I(e,n,t[n]);return e};const x=({dataSourceName:e,docsLink:n,hasRequiredFields:a=!0,className:l})=>{const i=(0,t.useTheme2)(),c={container:(0,o.css)({p:{margin:0},"p + p":{marginTop:i.spacing(2)}}),text:(0,o.css)((s=J({},i.typography.body),u={color:i.colors.text.secondary,a:(0,o.css)({color:i.colors.text.link,textDecoration:"underline","&:hover":{textDecoration:"none"}})},T(s,S(u))))};var s,u;return r().createElement("div",{className:(0,o.cx)(c.container,l)},r().createElement("p",{className:c.text},"Before you can use the ",e," data source, you must configure it below or in the config file. For detailed instructions,"," ",r().createElement("a",{href:n,target:"_blank",rel:"noreferrer"},"view the documentation"),"."),a&&r().createElement("p",{className:c.text},r().createElement("i",null,"Fields marked with * are required")))},A=()=>{const e=(0,t.useStyles2)(_);return r().createElement("hr",{className:e.horizontalDivider})},_=e=>({horizontalDivider:(0,o.css)({borderTop:`1px solid ${e.colors.border.weak}`,margin:e.spacing(2,0),width:"100%"})});function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(){return W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},W.apply(this,arguments)}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){G(e,t,n[t])}))}return e}function N(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}class R extends n.PureComponent{render(){const{data:e}=this.props;return e&&e.length?r().createElement("div",null,r().createElement("h3",null,"Google Sheets Metadata"),e.map((e=>this.renderInfo(e)))):r().createElement("div",null,"No Data")}constructor(...e){super(...e),this.state={index:0},this.renderInfo=e=>{var t;const n=null===(t=e.meta)||void 0===t?void 0:t.custom;return n?r().createElement("div",null,r().createElement("h3",null,"Info"),r().createElement("pre",null,JSON.stringify(n,null,2))):null}}}function q(e,t,n,r,a,o,l){try{var i=e[o](l),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,a)}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class B extends a.DataSourceWithBackend{query(t){return(t=>{t.app!==e.CoreApp.Dashboard&&t.app!==e.CoreApp.PanelViewer&&t.targets.forEach((e=>{var n,r;(0,a.reportInteraction)("grafana_google_sheets_query_executed",{app:t.app,useTimeFilter:null!==(n=e.useTimeFilter)&&void 0!==n&&n,cacheDurationSeconds:null!==(r=e.cacheDurationSeconds)&&void 0!==r?r:0})}))})(t),super.query(t)}applyTemplateVariables(e,t){const n=(0,a.getTemplateSrv)();return function(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){U(e,t,n[t])}))}return e}({},e),{spreadsheet:n.replace(e.spreadsheet,t),range:e.range?n.replace(e.range,t):""})}getSpreadSheets(){var e,t=this;return(e=function*(){return t.getResource("spreadsheets").then((({spreadsheets:e})=>e?Object.entries(e).map((([e,t])=>({label:t,value:e}))):[]))},function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function l(e){q(o,r,a,l,i,"next",e)}function i(e){q(o,r,a,l,i,"throw",e)}l(void 0)}))})()}constructor(e){super(e),this.annotations={},this.authType=e.jsonData.authenticationType}}const L=new e.DataSourcePlugin(B).setConfigEditor((function(n){var a;const o=function(e){var t;const n=function(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}(P({},e),{jsonData:P({},e.jsonData),secureJsonFields:P({},e.secureJsonFields)});return n.jsonData.authenticationType=e.jsonData.authenticationType||e.jsonData.authType,n.jsonData.authenticationType===b.JWT&&(null===(t=e.secureJsonFields)||void 0===t?void 0:t.jwt)&&(n.jsonData.clientEmail="configured",n.jsonData.defaultProject="configured",n.jsonData.tokenUri="configured",n.secureJsonFields.privateKey=!0),n}(n.options),l={isConfigured:Boolean(o.secureJsonFields.apiKey),value:(null===(a=o.secureJsonData)||void 0===a?void 0:a.apiKey)||"",placeholder:"Enter API key",id:"apiKey",onReset:()=>n.onOptionsChange(N(K({},o),{secureJsonFields:N(K({},o.secureJsonFields),{apiKey:!1}),secureJsonData:{apiKey:""},jsonData:o.jsonData})),onChange:(0,e.onUpdateDatasourceSecureJsonDataOption)(n,"apiKey")};return r().createElement(r().Fragment,null,r().createElement(x,{dataSourceName:"Google Sheets",docsLink:"https://grafana.com/grafana/plugins/grafana-googlesheets-datasource/",hasRequiredFields:!1}),r().createElement(A,null),r().createElement(w,{authenticationType:o.jsonData.authenticationType}),r().createElement(A,null),r().createElement(g.AuthConfig,{authOptions:E,onOptionsChange:n.onOptionsChange,options:o}),o.jsonData.authenticationType===b.API&&r().createElement(t.Field,{label:"API Key"},r().createElement(t.SecretInput,W({},l,{label:"API key",width:40}))))})).setQueryEditor(m).setMetadataInspector(R)})(),s})()));
//# sourceMappingURL=module.js.map